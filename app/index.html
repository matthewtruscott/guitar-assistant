<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="temp/styles/styles.css">
  </head>
  <body>
    <div class="guitar-neck">



    </div>
    <div class="dashboard">

      <select class="key">
        <option value="A">A</option>
        <option value="B">B</option>
        <option selected value="C">C</option>
        <option value="D">D</option>
        <option value="E">E</option>
        <option value="F">F</option>
        <option value="G">G</option>
      </select>
      <select class="modifier">
        <option selected value="major">Major</option>
        <option value="minor">Minor</option>
      </select>

      <h1 class="selected-chord-intervals"></h3>

    </div>

  <script src="../node_modules/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript">
  var keyInput = $('.key');
  var modifierInput = $('.modifier');

  var selectedNote = keyInput.val();
  var selectedNoteModifier = modifierInput.val();

  var guitarNeck = $('.guitar-neck');

  var string1 = 'E';
  var string2 = 'B';
  var string3 = 'G';
  var string4 = 'D';
  var string5 = 'A';
  var string6 = 'E';

  var stringArray = [string1,string2,string3,string4,string5,string6];

  var Notes = {
    "A" : ['A','A#','B','C','C#','D','D#','E','F','F#','G','G#'],
    "B" : ['B','C','C#','D','D#','E','F','F#','G','G#','A','A#'],
    "C" : ['C','C#','D','D#','E','F','F#','G','G#','A','A#','B'],
    "D" : ['D','D#','E','F','F#','G','G#','A','A#','B','C','C#'],
    "E" : ['E','F','F#','G','G#','A','A#','B','C','C#','D','D#'],
    "F" : ['F','F#','G','G#','A','A#','B','C','C#','D','D#','E'],
    "G" : ['G','G#','A','A#','B','C','C#','D','D#','E','F','F#'],
  }

  var chromaticNotes = ['A','A#','B','C','C#','D','D#','E','F','F#','G','G#'];



  var NoteColours = {
    "A" : '#f44336',
    "A#" : '#ff5722',
    "B" : '#ff9800',
    "C" : '#ffeb3b',
    "C#" : '#cddc39',
    "D" : '#8bc34a',
    "D#" : '#4caf50',
    "E" : '#00bcd4',
    "F" : '#2196f3',
    "F#" : '#3f51b5',
    "G" : '#673ab7',
    "G#" : '#9c27b0'
  }



  function renderNeck() {

    var selectedNote = keyInput.val();
    var selectedNoteModifier = modifierInput.val();
    var selectedChordNotes = {};

    // creates the array of current notes
    var indexOfNote = chromaticNotes.indexOf(selectedNote);
    var selectedNoteArray = [];
    for (var i = indexOfNote; i < chromaticNotes.length; i++) {
      selectedNoteArray.push(chromaticNotes[i]);
    }
    for (var i = 0; i < indexOfNote; i++) {
      selectedNoteArray.push(chromaticNotes[i]);
    }

    function createSelectedNotes(selectedNote, selectedNoteModifier) {

      if (selectedNoteModifier == "major") {
        var index = 0;
        selectedChordNotes[1] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[2] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[3] = selectedNoteArray[index];
        index += 1;
        selectedChordNotes[4] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[5] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[6] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[7] = selectedNoteArray[index];
      }

      if (selectedNoteModifier == "minor") {
        var index = 0;
        selectedChordNotes[1] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[2] = selectedNoteArray[index];
        index += 1;
        selectedChordNotes[3] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[4] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[5] = selectedNoteArray[index];
        index += 1;
        selectedChordNotes[6] = selectedNoteArray[index];
        index += 2;
        selectedChordNotes[7] = selectedNoteArray[index];
      }

      console.log(selectedChordNotes);


    }

    createSelectedNotes(selectedNote, selectedNoteModifier);

    function createSelectedChordNotes() {

      var selectedChordNotesHtml = "";

      for (note in selectedChordNotes) {
        var colourOfNote = NoteColours[selectedChordNotes[note]];

        selectedChordNotesHtml += "<span class='selected-chord-intervals__interval-"+note+"' style='border: 2px solid "+colourOfNote+"'>" + selectedChordNotes[note] + "</span>" + " ";
      }

      selectedChordNotesHtml += "<span class='selected-chord-intervals__interval-8' style='border: 2px solid "+NoteColours[selectedChordNotes[1]]+"'>" + selectedChordNotes[1] + "</span>" + " ";


      // selectedChordNotesHtml += "<span class='selected-chord-intervals__interval-1'>" + selectedChordNotes[1] + "</span>" + " ";
      //
      // selectedChordNotesHtml += "<span>" + selectedChordNotes[2] + "</span>" + " ";
      //
      // selectedChordNotesHtml += "<span class='selected-chord-intervals__interval-3'>" + selectedChordNotes[3] + "</span>" + " ";
      //
      // selectedChordNotesHtml += "<span>" + selectedChordNotes[4] + "</span>" + " ";
      //
      // selectedChordNotesHtml += "<span class='selected-chord-intervals__interval-5'>" + selectedChordNotes[5] + "</span>" + " ";
      //
      // selectedChordNotesHtml += "<span>" + selectedChordNotes[6] + "</span>" + " ";
      //
      // selectedChordNotesHtml += "<span class='selected-chord-intervals__interval-7'>" + selectedChordNotes[7] + "</span>" + " ";




      $('.selected-chord-intervals').html(selectedChordNotesHtml);

    }

    createSelectedChordNotes();



    guitarNeck.css({
      "height" : window.innerWidth * 0.1 + 'px',
      "width" : window.innerWidth * 0.8 + 'px',
      "margin" : window.innerWidth * 0.1 + 'px',
      "background-color" : "#FFE082"
    });


    var numberOfFrets = 22,
    numberOfStrings = 6,
    neckWidth = window.innerWidth * 0.8,
    avgFretLength = neckWidth / numberOfFrets;

    var maxFretWidth = 1,
    minFretWidth = 0.25;

    var differenceBetweenFretMinMax = maxFretWidth - minFretWidth,
    maxFretWidthPx = avgFretLength / (1 - differenceBetweenFretMinMax/2);

    function outputFretLength(fret) {
    fret = numberOfFrets - fret;
    return  (minFretWidth + differenceBetweenFretMinMax / numberOfFrets * fret);

    }

    var guitarNeckHtml = "";

    //fret loop
    for (var fret_i = 0; fret_i < numberOfFrets; fret_i++) {
      var fretHtml = "";
      var fretNumber = fret_i + 1;
      var fretLength = maxFretWidthPx * outputFretLength(fretNumber);

      fretHtml += "<div class='fret' fret-num='" + fretNumber + "'  style='width: "+fretLength+"px'>";

      fretHtml += "<div class='fret__number-label'>"+fretNumber+"</div>"

      //string loop
      for (var string_i = 0; string_i < numberOfStrings; string_i++) {
        var stringHtml = "";
        var stringNumber = string_i + 1;
        var stringTune = stringArray[string_i];
        var stringNoteIndex = fretNumber % 12;
        var stringNote = Notes[stringTune][stringNoteIndex];
        var noteColour = NoteColours[stringNote];

        var noteHighlighted = false;
        for (var note in selectedChordNotes) {
          if (selectedChordNotes.hasOwnProperty(note)) {
              if (selectedChordNotes[note] == stringNote) {
                noteHighlighted = true;
              }
          }
        }

        var noteIsRoot = false;
        if (stringNote == selectedNote) {
          noteIsRoot = true;
        }


        stringHtml += "<div class='guitar-string' string-note='" + stringNote + "' string-tune='" + stringTune + "' string-num='" + stringNumber + "'>";

        if (noteHighlighted == true) {

          if (noteIsRoot == true) {
            stringHtml += "<div class='guitar-string__background' style='border: 4px solid white; background-color: "+noteColour+";'>";
          }else{
            stringHtml += "<div class='guitar-string__background' style='background-color: "+noteColour+"; box-shadow: 0px 0px 15px -2px rgba(0,0,0,0.2)'>";
          }



        }else{
          stringHtml += "<div class='guitar-string__background'>";
        }


            stringHtml += stringNote;

          stringHtml += "</div>";


        stringHtml += "</div>";
        fretHtml += stringHtml;

      }

      fretHtml += "</div>";
      guitarNeckHtml += fretHtml;
    }

    guitarNeck.html(guitarNeckHtml);

    $('.fret[fret-num="3"]').addClass('single-dot');

    $('.fret[fret-num="5"]').addClass('single-dot');

    $('.fret[fret-num="7"]').addClass('single-dot');

    $('.fret[fret-num="9"]').addClass('single-dot');

    $('.fret[fret-num="12"]').addClass('double-dot');

    $('.fret[fret-num="15"]').addClass('single-dot');

    $('.fret[fret-num="17"]').addClass('single-dot');

    $('.fret[fret-num="19"]').addClass('single-dot');

    $('.fret[fret-num="21"]').addClass('single-dot');

  }

  renderNeck();

  $(window).on('resize', renderNeck);

  $('.key, .modifier').on('change', renderNeck);




  </script>
  </body>
</html>
